(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.leadUi=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var Component=require("./src/component");var Components=require("./src/components");var Renderer=require("./src/renderer");module.exports={Component:Component,Components:Components,Renderer:Renderer}},{"./src/component":38,"./src/components":39,"./src/renderer":42}],2:[function(require,module,exports){},{}],3:[function(require,module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],4:[function(require,module,exports){(function(Buffer){var useBuffer=typeof Buffer!=="undefined";function clone(parent,opts){var depth,prototype,filter,allParents=[],allChildren=[],options={};opts=opts||{};options.depth=opts.depth!==undefined?opts.depth:Infinity;options.circular=opts.circular!==undefined?opts.circular:true;function _clone(parent,depth){if(parent===null){return null}if(depth===0||typeof parent!=="object"){return parent}var i,child,proto,attrs,index;if(Array.isArray(parent)){child=[]}else if(toString.call(parent)==="[object RegExp]"){child=new RegExp(parent.source,_getRegExpFlags(parent));if(parent.lastIndex){child.lastIndex=parent.lastIndex}}else if(toString.call(parent)==="[object Date]"){return new Date(parent.getTime())}else if(useBuffer&&Buffer.isBuffer(parent)){child=new Buffer(parent.length);parent.copy(child);return child}else if(!!(parent&&parent.constructor&&parent.constructor.BYTES_PER_ELEMENT>0)){return new parent.constructor(parent)}else{if(typeof options.prototype==="undefined"){proto=Object.getPrototypeOf(parent);child=Object.create(proto)}else{child=Object.create(prototype);proto=prototype}}if(options.circular){index=allParents.indexOf(parent);if(index!==-1){return allChildren[index]}allParents.push(parent);allChildren.push(child)}for(i in parent){if(proto){attrs=Object.getOwnPropertyDescriptor(proto,i)}if(attrs&&attrs.set===null){continue}child[i]=_clone(parent[i],depth-1)}return child}return _clone(parent,options.depth)}function _getRegExpFlags(re){var flags="";if(re.global)flags+="g";if(re.ignoreCase)flags+="i";if(re.multiline)flags+="m";return flags}module.exports=clone}).call(this,require("buffer").Buffer)},{buffer:2}],5:[function(require,module,exports){var toCamelCase=require("to-camel-case");var hasRemovePropertyInStyle=typeof document!=="undefined"&&"removeProperty"in document.createElement("a").style;function css(element,name,value){var name;if(arguments.length===3){name=toCamelCase(name==="float"?"cssFloat":name);if(value){element.style[name]=value;return value}if(hasRemovePropertyInStyle){element.style.removeProperty(name)}else{element.style[name]=""}return value}if(typeof name==="string"){name=toCamelCase(name==="float"?"cssFloat":name);return element.style[name]}var style=name;for(name in style){css(element,name,style[name])}return style}module.exports=css},{"to-camel-case":35}],6:[function(require,module,exports){function query(selector,element){return query.one(selector,element)}var one=function(selector,element){return element.querySelector(selector)};var all=function(selector,element){return element.querySelectorAll(selector)};query.one=function(selector,element){if(!selector){return}if(typeof selector==="string"){element=element||document;return one(selector,element)}if(selector.length!==undefined){return selector[0]}return selector};query.all=function(selector,element){if(!selector){return[]}var list;if(typeof selector!=="string"){if(selector.length===undefined){return[selector]}list=selector}else{element=element||document;list=all(selector,element)}return Array.prototype.slice.call(list)};query.engine=function(engine){if(!engine.one){throw new Error(".one callback required")}if(!engine.all){throw new Error(".all callback required")}one=engine.one;all=engine.all;return query};module.exports=query},{}],7:[function(require,module,exports){module.exports={area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,menuitem:true,meta:true,param:true,source:true,track:true,wbr:true}},{}],8:[function(require,module,exports){var namespaces={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function patch(element,previous,attrs){if(!previous&&!attrs){return attrs}var attrName,ns,name,value,split;previous=previous||{};attrs=attrs||{};for(attrName in previous){if(previous[attrName]&&!attrs[attrName]){split=splitAttrName(attrName);ns=namespaces[split[0]];name=split[1];element.removeAttributeNS(ns,name)}}for(attrName in attrs){value=attrs[attrName];if(previous[attrName]===value){continue}split=splitAttrName(attrName);ns=namespaces[split[0]];name=split[1];element.setAttributeNS(ns,name,value)}return attrs}function splitAttrName(attrName){return attrName.split(":")}module.exports={patch:patch,namespaces:namespaces}},{}],9:[function(require,module,exports){var style=require("./style");var stringifyClass=require("../../util/stringify-class");function patch(element,previous,attrs){if(!previous&&!attrs){return attrs}var name,value;previous=previous||{};attrs=attrs||{};for(name in previous){if(!previous[name]||attrs[name]!=null){continue}unset(name,element,previous)}for(name in attrs){set(name,element,previous,attrs)}return attrs}function set(name,element,previous,attrs){if(set.handlers[name]){set.handlers[name](name,element,previous,attrs)}else if(attrs[name]!=null&&previous[name]!==attrs[name]){element.setAttribute(name,attrs[name])}}set.handlers=Object.create(null);function unset(name,element,previous){if(unset.handlers[name]){unset.handlers[name](name,element,previous)}else{element.removeAttribute(name)}}unset.handlers=Object.create(null);set.handlers.type=function(name,element,previous,attrs){if(previous[name]===attrs[name]){return}var value=element.getAttribute("value");element.setAttribute(name,attrs[name]);element.setAttribute("value",value);element.value=value};set.handlers.value=function(name,element,previous,attrs){if(previous[name]===attrs[name]){return}element.setAttribute(name,attrs[name]);element[name]=attrs[name]?attrs[name]:""};set.handlers["class"]=function(name,element,previous,attrs){if(attrs[name]==null){return}element.setAttribute(name,stringifyClass(attrs[name]))};set.handlers.style=function(name,element,previous,attrs){style.patch(element,previous[name],attrs[name])};unset.handlers.style=function(name,element,previous){style.patch(element,previous[name])};module.exports={patch:patch,set:set,unset:unset}},{"../../util/stringify-class":23,"./style":13}],10:[function(require,module,exports){function patch(element,previous,dataset){if(!previous&&!dataset){return dataset}var name;previous=previous||{};dataset=dataset||{};for(name in previous){if(dataset[name]===undefined){delete element.dataset[name]}}for(name in dataset){if(previous[name]===dataset[name]){continue}element.dataset[name]=dataset[name]}return dataset}module.exports={patch:patch}},{}],11:[function(require,module,exports){var dataset=require("./dataset");var stringifyClass=require("../../util/stringify-class");function patch(element,previous,props){if(!previous&&!props){return props}var name,value;previous=previous||{};props=props||{};for(name in previous){if(previous[name]===undefined||props[name]!==undefined){continue}unset(name,element,previous)}for(name in props){set(name,element,previous,props)}return props}function set(name,element,previous,props){if(set.handlers[name]){set.handlers[name](name,element,previous,props)}else if(previous[name]!==props[name]){element[name]=props[name]}}set.handlers=Object.create(null);function unset(name,element,previous){if(unset.handlers[name]){unset.handlers[name](name,element,previous)}else{element[name]=null}}unset.handlers=Object.create(null);set.handlers.type=function(name,element,previous,props){if(previous[name]===props[name]){return}var value=element.value;element[name]=props[name];element.value=value};set.handlers.className=function(name,element,previous,props){element.className=props[name]?stringifyClass(props[name]):""};set.handlers.dataset=function(name,element,previous,props){dataset.patch(element,previous[name],props[name])};unset.handlers.className=function(name,element,previous){element.className=""};unset.handlers.dataset=function(name,element,previous){dataset.patch(element,previous[name],{})};module.exports={patch:patch,set:set,unset:unset}},{"../../util/stringify-class":23,"./dataset":10}],12:[function(require,module,exports){var isArray=Array.isArray;function selectValue(node){if(node.tagName!=="select"){return}var value=node.attrs&&node.attrs.value;value=value||node.props&&node.props.value;if(value==null){return}var values={};if(!isArray(value)){values[value]=value}else{for(var i=0,len=value.length;i<len;i++){values[value[i]]=value[i]}}populateOptions(node,values);if(node.attrs&&node.attrs.hasOwnProperty("value")){delete node.attrs.value}if(node.props&&node.props.hasOwnProperty("value")){delete node.props.value}}function populateOptions(node,values){if(node.tagName!=="option"){for(var i=0,len=node.children.length;i<len;i++){populateOptions(node.children[i],values)}return}var value=node.attrs&&node.attrs.value;value=value||node.props&&node.props.value;if(!values.hasOwnProperty(value)){return}node.attrs=node.attrs||{};node.attrs.selected="selected";node.props=node.props||{};node.props.selected=true}module.exports=selectValue},{}],13:[function(require,module,exports){var domElementCss=require("dom-element-css");function patch(element,previous,style){if(!previous&&!style){return style}var rule;if(typeof style==="object"){if(typeof previous==="object"){for(rule in previous){if(!style[rule]){domElementCss(element,rule,null)}}domElementCss(element,style)}else{if(previous){element.setAttribute("style","")}domElementCss(element,style)}}else{element.setAttribute("style",style||"")}}module.exports={patch:patch}},{"dom-element-css":5}],14:[function(require,module,exports){var voidElements=require("void-elements");var attach=require("../tree/attach");var render=require("../tree/render");var update=require("../tree/update");var props=require("./patcher/props");var attrs=require("./patcher/attrs");var attrsNS=require("./patcher/attrs-n-s");var selectValue=require("./patcher/select-value");var stringifyAttrs=require("../util/stringify-attrs");function Tag(tagName,config,children){this.tagName=tagName||"div";config=config||{};this.children=children||[];this.props=config.props;this.attrs=config.attrs;this.attrsNS=config.attrsNS;this.events=config.events;this.hooks=config.hooks;this.data=config.data;this.element=undefined;this.parent=undefined;this.key=config.key!=null?config.key:undefined;this.namespace=config.attrs&&config.attrs.xmlns||null;this.is=config.attrs&&config.attrs.is||null}Tag.prototype.type="Tag";Tag.prototype.create=function(){var element;if(this.namespace){if(this.is){element=document.createElementNS(this.namespace,this.tagName,this.is)}else{element=document.createElementNS(this.namespace,this.tagName)}}else{if(this.is){element=document.createElement(this.tagName,this.is)}else{element=document.createElement(this.tagName)}}return element};Tag.prototype.render=function(container,parent){this.parent=parent;if(!this.namespace){if(this.tagName==="svg"){this.namespace="http://www.w3.org/2000/svg"}else if(this.tagName==="math"){this.namespace="http://www.w3.org/1998/Math/MathML"}else if(parent){this.namespace=parent.namespace}}var element=this.element=this.create();if(this.events){element.domLayerNode=this}if(this.tagName==="select"){selectValue(this)}if(this.props){props.patch(element,{},this.props)}if(this.attrs){attrs.patch(element,{},this.attrs)}if(this.attrsNS){attrsNS.patch(element,{},this.attrsNS)}container=container?container:document.createDocumentFragment();container.appendChild(element);render(element,this.children,this);if(this.hooks&&this.hooks.created){this.hooks.created(this,element)}return element};Tag.prototype.attach=function(element,parent){this.parent=parent;this.element=element;if(this.events){element.domLayerNode=this}props.patch(element,{},this.props);attach(element,this.children,this);if(this.hooks&&this.hooks.created){this.hooks.created(this,element)}return element};Tag.prototype.match=function(to){return!(this.type!==to.type||this.tagName!==to.tagName||this.key!==to.key||this.namespace!==to.namespace||this.is!==to.is)};Tag.prototype.patch=function(to){if(!this.match(to)){this.remove(false);return to.render(this.element.parentNode,this.parent)}to.element=this.element;if(this.tagName==="select"){selectValue(to)}if(this.props||to.props){props.patch(to.element,this.props,to.props)}if(this.attrs||to.attrs){attrs.patch(to.element,this.attrs,to.attrs)}if(this.attrsNS||to.attrsNS){attrsNS.patch(to.element,this.attrsNS,to.attrsNS)}update(to.element,this.children,to.children);if(to.events){to.element.domLayerNode=to}else if(this.events){to.element.domLayerNode=undefined}if(this.hooks&&this.hooks.updated){this.hooks.updated(this,to.element)}return to.element};Tag.prototype.remove=function(destroy){broadcastRemove(this);if(destroy!==false){this.destroy()}};Tag.prototype.destroy=function(){var element=this.element;if(!element){return}var parentNode=element.parentNode;if(!parentNode){return}if(!this.hooks||!this.hooks.destroy){return parentNode.removeChild(element)}return this.hooks.destroy(element,function(){return parentNode.removeChild(element)})};function broadcastRemove(node){if(node.children){for(var i=0,len=node.children.length;i<len;i++){broadcastRemove(node.children[i])}}if(node.hooks&&node.hooks.remove){node.hooks.remove(node,node.element)}}Tag.prototype.toHtml=function(){var attrs=stringifyAttrs(this.attrs,this.tagName);var attrsNS=stringifyAttrs(this.attrsNS,this.tagName);var html="<"+this.tagName+(attrs?" "+attrs:"")+(attrsNS?" "+attrsNS:"")+">";var len=this.children.length;if(this.props&&this.props.innerHTML&&len===0){html+=this.props.innerHTML}else{for(var i=0;i<len;i++){html+=this.children[i].toHtml()}}html+=voidElements[this.tagName]?"":"</"+this.tagName+">";return html};module.exports=Tag},{"../tree/attach":16,"../tree/render":19,"../tree/update":21,"../util/stringify-attrs":22,"./patcher/attrs":9,"./patcher/attrs-n-s":8,"./patcher/props":11,"./patcher/select-value":12,"void-elements":7}],15:[function(require,module,exports){var escapeHtml=require("escape-html");function Text(data){this.data=data;this.element=undefined;this.parent=undefined}Text.prototype.type="Text";Text.prototype.create=function(){return document.createTextNode(this.data)};Text.prototype.render=function(container,parent){this.parent=parent;this.element=this.create();container=container?container:document.createDocumentFragment();container.appendChild(this.element);return this.element};Text.prototype.attach=function(element,parent){this.parent=parent;return this.element=element};Text.prototype.match=function(to){return this.type===to.type};Text.prototype.patch=function(to){if(!this.match(to)){this.remove(false);return to.render(this.element.parentNode,this.parent)}to.element=this.element;if(this.data!==to.data){this.element.data=to.data}return this.element};Text.prototype.remove=function(destroy){if(destroy!==false){this.destroy()}};Text.prototype.destroy=function(){var parentNode=this.element.parentNode;return parentNode.removeChild(this.element)};Text.prototype.toHtml=function(){return escapeHtml(this.data)};module.exports=Text},{"escape-html":26}],16:[function(require,module,exports){var isArray=Array.isArray;function attach(container,nodes,parent){if(typeof nodes==="function"){nodes=nodes(container,parent)}if(!isArray(nodes)){nodes=[nodes]}var i=0,j=0;var childNodes=container.childNodes;var nodesLen=nodes.length;var text,textLen,size;while(i<nodesLen){if(!nodes[i]){i++;continue}if(nodes[i].type!=="Text"){nodes[i].attach(childNodes[j],parent);i++}else{size=nodes[i].data.length;text=childNodes[j].data;nodes[i].data=text;nodes[i].attach(childNodes[j],parent);i++;textLen=text.length;while(size<textLen&&i<nodesLen){size+=nodes[i].data.length;nodes[i].data="";i++}}j++}return nodes}module.exports=attach},{}],17:[function(require,module,exports){var isEmpty=require("is-empty");var isArray=Array.isArray;function patch(container,children,toChildren,parent){var fromChildren=children.slice();var fromStartIndex=0,toStartIndex=0;var fromEndIndex=fromChildren.length-1;var fromStartNode=fromChildren[0];var fromEndNode=fromChildren[fromEndIndex];var toEndIndex=toChildren.length-1;var toStartNode=toChildren[0];var toEndNode=toChildren[toEndIndex];var indexes,index,node,before;while(fromStartIndex<=fromEndIndex&&toStartIndex<=toEndIndex){if(fromStartNode===undefined){fromStartNode=fromChildren[++fromStartIndex]}else if(fromEndNode===undefined){fromEndNode=fromChildren[--fromEndIndex]}else if(fromStartNode.match(toStartNode)){fromStartNode.patch(toStartNode);fromStartNode=fromChildren[++fromStartIndex];toStartNode=toChildren[++toStartIndex]}else if(fromEndNode.match(toEndNode)){fromEndNode.patch(toEndNode);fromEndNode=fromChildren[--fromEndIndex];toEndNode=toChildren[--toEndIndex]}else if(fromStartNode.match(toEndNode)){fromStartNode.patch(toEndNode);container.insertBefore(fromStartNode.element,fromEndNode.element.nextSibling);fromStartNode=fromChildren[++fromStartIndex];toEndNode=toChildren[--toEndIndex]}else if(fromEndNode.match(toStartNode)){fromEndNode.patch(toStartNode);container.insertBefore(fromEndNode.element,fromStartNode.element);fromEndNode=fromChildren[--fromEndIndex];toStartNode=toChildren[++toStartIndex]}else{if(indexes===undefined){indexes=keysIndexes(fromChildren,fromStartIndex,fromEndIndex)}index=indexes[toStartNode.key];if(index===undefined){container.insertBefore(toStartNode.render(parent),fromStartNode.element);toStartNode=toChildren[++toStartIndex]}else{node=fromChildren[index];node.patch(toStartNode);fromChildren[index]=undefined;container.insertBefore(node.element,fromStartNode.element);toStartNode=toChildren[++toStartIndex]}}}if(fromStartIndex>fromEndIndex){before=toChildren[toEndIndex+1]===undefined?null:toChildren[toEndIndex+1].element;for(;toStartIndex<=toEndIndex;toStartIndex++){container.insertBefore(toChildren[toStartIndex].render(parent),before)}}else if(toStartIndex>toEndIndex){for(;fromStartIndex<=fromEndIndex;fromStartIndex++){if(fromChildren[fromStartIndex]!==undefined){fromChildren[fromStartIndex].remove()}}}return toChildren}function keysIndexes(children,startIndex,endIndex){var i,keys=Object.create(null),key;for(i=startIndex;i<=endIndex;++i){key=children[i].key;if(key!==undefined){keys[key]=i}}return keys}module.exports=patch},{"is-empty":33}],18:[function(require,module,exports){function remove(nodes,parent){for(var i=0,len=nodes.length;i<len;i++){nodes[i].remove()}}module.exports=remove},{}],19:[function(require,module,exports){var isArray=Array.isArray;function render(container,nodes,parent){if(typeof nodes==="function"){nodes=nodes(container,parent)}if(!isArray(nodes)){nodes=[nodes]}for(var i=0,len=nodes.length;i<len;i++){if(nodes[i]){nodes[i].render(container,parent)}}return nodes}module.exports=render},{}],20:[function(require,module,exports){var query=require("dom-query");var attach=require("./attach");var render=require("./render");var update=require("./update");var remove=require("./remove");var isArray=Array.isArray;function Tree(){this._mounted=Object.create(null)}Tree.prototype.mount=function(selector,factory,data){data=data||{};var containers=query.all(selector);if(containers.length!==1){throw new Error("The selector must identify an unique DOM element")}var container=containers[0];if(container.domLayerTreeId){this.unmount(container.domLayerTreeId)}var mountId=data.mountId?data.mountId:this.uuid();var fragment=document.createDocumentFragment();data.container=container;data.factory=factory;data.children=render(fragment,factory,null);container.appendChild(fragment);this._mounted[mountId]=data;return container.domLayerTreeId=mountId};Tree.prototype.attach=function(selector,factory,data){data=data||{};var containers=query.all(selector);if(containers.length!==1){throw new Error("The selector must identify an unique DOM element")}var container=containers[0];if(container.domLayerTreeId){this.unmount(container.domLayerTreeId)}var mountId=data.mountId?data.mountId:this.uuid();data.container=container;data.factory=factory;data.children=attach(container,factory,null);this._mounted[mountId]=data;return container.domLayerTreeId=mountId};Tree.prototype.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})};Tree.prototype.unmount=function(mountId){if(arguments.length){var mount=this._mounted[mountId];if(mount){remove(mount.children);delete mount.container.domLayerTreeId;delete this._mounted[mountId]}return}for(mountId in this._mounted){this.unmount(mountId)}};Tree.prototype.update=function(mountId,tree){if(arguments.length){var mount=this._mounted[mountId];if(mount){var active=document.activeElement;mount.children=update(mount.container,mount.children,tree?tree:mount.factory,null);if(document.activeElement!==active){active.focus()}}return}for(mountId in this._mounted){this.update(mountId)}};Tree.prototype.mounted=function(mountId){if(arguments.length){return this._mounted[mountId]}return this._mounted};module.exports=Tree},{"./attach":16,"./remove":18,"./render":19,"./update":21,"dom-query":6}],21:[function(require,module,exports){var patch=require("./patch");var isArray=Array.isArray;function update(container,fromNodes,toNodes,parent){if(typeof toNodes==="function"){toNodes=toNodes(container,parent)}if(!isArray(toNodes)){toNodes=[toNodes]}return patch(container,fromNodes,toNodes,parent)}module.exports=update},{"./patch":17}],22:[function(require,module,exports){var stringifyStyle=require("./stringify-style");var stringifyClass=require("./stringify-class");function stringifyAttrs(attrs,tagName){if(!attrs){return""}var attributes=[],value;for(var key in attrs){value=attrs[key];if(key==="style"){value=stringifyStyle(value)}else if(key==="class"){value=stringifyClass(value)}if(key==="value"&&(/^(?:textarea|select)$/i.test(tagName)||attrs.contenteditable)){continue}attributes.push(key+'="'+String(value).replace(/"/g,'\\"')+'"')}return attributes.join(" ")}module.exports=stringifyAttrs},{"./stringify-class":23,"./stringify-style":24}],23:[function(require,module,exports){function stringifyClass(classAttr){if(typeof classAttr==="string"){return classAttr}var classes=[];for(var key in classAttr){if(classAttr[key]){classes.push(key)}}return classes.join(" ")}module.exports=stringifyClass},{}],24:[function(require,module,exports){function stringifyStyle(style){if(typeof style==="string"){return style}var values=[];for(var key in style){values.push(key+":"+style[key])}return values.join(";")}module.exports=stringifyStyle},{}],25:[function(require,module,exports){arguments[4][6][0].apply(exports,arguments)},{dup:6}],26:[function(require,module,exports){module.exports=escapeHtml;function escapeHtml(html){return String(html).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{}],27:[function(require,module,exports){function baseExtend(args,deep){var i,j,obj,src,key,keys,len;var target=args[0];var length=args.length;for(i=1;i<length;++i){obj=args[i];if((obj===null||typeof obj!=="object")&&typeof obj!=="function"){continue}keys=Object.keys(obj);len=keys.length;for(j=0;j<len;j++){key=keys[j];src=obj[key];if(deep&&src!==null&&typeof src==="object"){if(target[key]===null||typeof target[key]!=="object"){target[key]=Array.isArray(src)?[]:{}}baseExtend([target[key],src],true)}else{target[key]=src}}}return target}module.exports=baseExtend},{}],28:[function(require,module,exports){var baseExtend=require("./base-extend");module.exports=function(){return baseExtend(arguments,false)}},{"./base-extend":27}],29:[function(require,module,exports){var extend=require("./extend");var merge=require("./merge");module.exports={extend:extend,merge:merge}},{"./extend":28,"./merge":30}],30:[function(require,module,exports){var baseExtend=require("./base-extend");module.exports=function(){return baseExtend(arguments,true)}},{"./base-extend":27}],31:[function(require,module,exports){var isFunction=require("is-function");module.exports=forEach;var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;function forEach(list,iterator,context){if(!isFunction(iterator)){throw new TypeError("iterator must be a function")}if(arguments.length<3){context=this}if(toString.call(list)==="[object Array]")forEachArray(list,iterator,context);else if(typeof list==="string")forEachString(list,iterator,context);else forEachObject(list,iterator,context)}function forEachArray(array,iterator,context){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){iterator.call(context,array[i],i,array)}}}function forEachString(string,iterator,context){for(var i=0,len=string.length;i<len;i++){iterator.call(context,string.charAt(i),i,string)}}function forEachObject(object,iterator,context){for(var k in object){if(hasOwnProperty.call(object,k)){iterator.call(context,object[k],k,object)}}}},{"is-function":32}],32:[function(require,module,exports){module.exports=isFunction;var toString=Object.prototype.toString;function isFunction(fn){var string=toString.call(fn);return string==="[object Function]"||typeof fn==="function"&&string!=="[object RegExp]"||typeof window!=="undefined"&&(fn===window.setTimeout||fn===window.alert||fn===window.confirm||fn===window.prompt)}},{}],33:[function(require,module,exports){module.exports=isEmpty;var has=Object.prototype.hasOwnProperty;function isEmpty(val){if(null==val)return true;if("number"==typeof val)return 0===val;if(undefined!==val.length)return 0===val.length;for(var key in val)if(has.call(val,key))return false;return true}},{}],34:[function(require,module,exports){function isObject(value){return value!==null&&typeof value==="object"}function isPlainObject(value){return isObject(value)&&value.constructor===Object}function isArray(value){return Array.isArray(value)}function isNumber(value){return typeof value=="number"}function isString(value){return typeof value==="string"}function isBoolean(value){return typeof value==="boolean"}function isTypedArray(value){return!!(value&&value.constructor&&value.constructor.BYTES_PER_ELEMENT>0)}function isFunction(value){return typeof value=="function"}function isDate(value){return toString.call(value)==="[object Date]"}function isRegExp(value){return toString.call(value)==="[object RegExp]"}function isScalar(value){return value===null||typeof value==="boolean"||typeof value==="number"||typeof value==="string"||typeof value==="undefined"}module.exports={isObject:isObject,isPlainObject:isPlainObject,isArray:isArray,isTypedArray:isTypedArray,isNumber:isNumber,isString:isString,isBoolean:isBoolean,isDate:isDate,isRegExp:isRegExp,isFunction:isFunction,isScalar:isScalar}},{}],35:[function(require,module,exports){var toSpace=require("to-space-case");module.exports=toCamelCase;function toCamelCase(string){return toSpace(string).replace(/\s(\w)/g,function(matches,letter){return letter.toUpperCase()})}},{"to-space-case":36}],36:[function(require,module,exports){var clean=require("to-no-case");module.exports=toSpaceCase;function toSpaceCase(string){return clean(string).replace(/[\W_]+(.|$)/g,function(matches,match){return match?" "+match:""})}},{"to-no-case":37}],37:[function(require,module,exports){module.exports=toNoCase;var hasSpace=/\s/;var hasCamel=/[a-z][A-Z]/;var hasSeparator=/[\W_]/;function toNoCase(string){if(hasSpace.test(string))return string.toLowerCase();if(hasSeparator.test(string))string=unseparate(string);if(hasCamel.test(string))string=uncamelize(string);return string.toLowerCase()}var separatorSplitter=/[\W_]+(.|$)/g;function unseparate(string){return string.replace(separatorSplitter,function(m,next){return next?" "+next:""})}var camelSplitter=/(.)([A-Z]+)/g;function uncamelize(string){return string.replace(camelSplitter,function(m,previous,uppers){return previous+" "+uppers.toLowerCase().split("").join(" ")})}},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _componentEmitter=require("component-emitter");var _componentEmitter2=_interopRequireDefault(_componentEmitter);var _util=require("./util");var _util2=_interopRequireDefault(_util);var Component=function(){function Component(options){_classCallCheck(this,Component);var template;options=options||{};this._scope=options.scope||{};this._parent=options.parent;this._children={};this._dirty=false;this.content(options.content||[]);this.renderer(options.renderer);this.template(options.template||'$.h("div")');this._data=options.data||{};this._ref=this._data.ref||"anonymous-component"+Component.counter++;if(this._parent){this._parent.register(this._ref,this);this._parent.invalidate()}this.vm(this._scope,this._data,this)}_createClass(Component,[{key:"content",value:function content(_content){if(_content){this._content=_content;
}return this._content}},{key:"template",value:function template(_template){if(_template){this._template=_template}return this._template}},{key:"renderer",value:function renderer(_renderer){if(_renderer){this._renderer=_renderer}return this._renderer}},{key:"virtual",value:function virtual(){return this._virtual}},{key:"children",value:function children(){return this._children}},{key:"parent",value:function parent(){return this._parent}},{key:"dirty",value:function dirty(value){if(arguments.length){this._dirty=!!value;if(this._dirty){_util2["default"].each(this.children(),function(child){child.dirty(true)}.bind(this));this.emit("refresh")}}return this._dirty}},{key:"invalidate",value:function invalidate(){if(this._parent&&this._parent.get()===this._scope){return this._parent.invalidate()}this.dirty(true)}},{key:"register",value:function register(ref,child){this._children[ref]=child}},{key:"unregister",value:function unregister(ref){delete this._children[ref]}},{key:"toHtml",value:function toHtml(){var node=this.render();return node?node.toHtml():""}},{key:"set",value:function set(path,value){var value=_util2["default"].set(this._scope,path,value);this.invalidate();return value}},{key:"get",value:function get(path){return _util2["default"].get(this._scope,path)}},{key:"render",value:function render(){var node=this.template()(this.renderer(),this.get(),this);node=_util2["default"].isArray(node)?node[0]:node;if(!node){return}node.hooks={created:function(node,element){this.on("refresh",function(){this.renderer().refresh(this)}.bind(this));this.emit("mounted",element)}.bind(this),dirty:function(node){return this.dirty()}.bind(this),remove:function(node,element){this.emit("unmounted",element)}.bind(this)};return node}},{key:"vm",value:function vm(scope,data,component){}}]);return Component}();(0,_componentEmitter2["default"])(Component.prototype);Component.counter=1;Component.prototype._emit=Component.prototype.emit;Component.prototype.emit=function(event){var args=Array.prototype.slice.call(arguments,1);var methodArgs=args.slice();methodArgs.unshift(this._scope);methodArgs.unshift(event);if(_util2["default"].isFunction(this[event])){this[event].apply(this,methodArgs.slice(1))}return this._emit.apply(this,methodArgs)};exports["default"]=Component;module.exports=exports["default"]},{"./util":43,"component-emitter":3}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Components=function(){function Components(options){_classCallCheck(this,Components);options=options||{};this._components={}}_createClass(Components,[{key:"register",value:function register(name,className){this._components[name.toLowerCase()]=className}},{key:"unregister",value:function unregister(name){delete this._components[name.toLowerCase()]}},{key:"exists",value:function exists(name){return name&&!!this._components[name.toLowerCase()]}},{key:"create",value:function create(name,options){options=options||{};if(!this.exists(name)){throw new Error("Error, unexisting Tag `"+name+"`.")}name=name.toLowerCase();return new this._components[name](options)}}]);return Components}();exports["default"]=Components;module.exports=exports["default"]},{}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _util=require("../util");var _util2=_interopRequireDefault(_util);function _each(expression,properties){var match=expression.match(/^\s*\((\w+),?\s*(\w+)?\)\s+in\s+(.+?)\s*$/);if(!match){throw new Error("Expected `'each'` expression to be a string of the following format '(item, value) in collection'.")}var params=[];var hasKey=match[2]!==undefined;var scope=properties.data.scope;if(!scope||!scope[match[3]]){return[]}var list=scope[match[3]];_util2["default"].each(list,function(value,key){var clone={props:properties.props,attrs:_util2["default"].extend({},properties.attrs),events:properties.events,callbacks:properties.callbacks,namespace:properties.namespace,data:_util2["default"].extend({},properties.data)};var s={};s.__proto__=scope;s[match[1]]=value;if(hasKey){s[match[2]]=key}clone.data.scope=s;clone.data.component=properties.data.component;params.push(clone)});return params}exports["default"]=_each;module.exports=exports["default"]},{"../util":43}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _util=require("../util");var _util2=_interopRequireDefault(_util);function _if(expression,properties){if(_util2["default"].isFunction(expression)){expression=expression(properties.data?properties.data.scope:{})}return expression==="true"?[properties]:[]}exports["default"]=_if;module.exports=exports["default"]},{"../util":43}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _domQuery=require("dom-query");var _domQuery2=_interopRequireDefault(_domQuery);var _domLayerSrcTreeTree=require("dom-layer/src/tree/tree");var _domLayerSrcTreeTree2=_interopRequireDefault(_domLayerSrcTreeTree);var _domLayerSrcNodeTag=require("dom-layer/src/node/tag");var _domLayerSrcNodeTag2=_interopRequireDefault(_domLayerSrcNodeTag);var _domLayerSrcNodeText=require("dom-layer/src/node/text");var _domLayerSrcNodeText2=_interopRequireDefault(_domLayerSrcNodeText);var _components2=require("./components");var _components3=_interopRequireDefault(_components2);var _util=require("./util");var _util2=_interopRequireDefault(_util);var _modifiersIf=require("./modifiers/if");var _modifiersIf2=_interopRequireDefault(_modifiersIf);var _modifiersEach=require("./modifiers/each");var _modifiersEach2=_interopRequireDefault(_modifiersEach);var Renderer=function(){function Renderer(options){_classCallCheck(this,Renderer);options=options||{};this._modifiers={};this._ordered=[];this._tree=options.tree||new _domLayerSrcTreeTree2["default"];this._components=options.components||new _components3["default"];this.register("if",_modifiersIf2["default"]);this.register("each",_modifiersEach2["default"])}_createClass(Renderer,[{key:"tree",value:function tree(_tree){if(_tree){this._tree=_tree}return this._tree}},{key:"components",value:function components(_components){if(_components){this._components=_components}return this._components}},{key:"register",value:function register(name,className){this._ordered.push(name);this._modifiers[name]=className}},{key:"unregister",value:function unregister(name){var index=this._ordered.indexOf(name);if(index>-1){this._ordered.splice(index,1);this._ordered=this._ordered.map(function(v){return this._ordered[v]}.bind(this))}delete this._modifiers[name]}},{key:"registered",value:function registered(){return this._ordered}},{key:"exists",value:function exists(name){return!!this._modifiers[name]}},{key:"priority",value:function priority(name){return this._ordered.indexOf(name)}},{key:"h",value:function h(tagName,config,children,scope,component){var modifiers=[];if(!tagName){return _util2["default"].isFunction(config)?new _domLayerSrcNodeText2["default"](config(children)):new _domLayerSrcNodeText2["default"](config)}config.data=config.data||{};config.data.scope=scope;config.data.component=component;_util2["default"].each(config.attrs,function(value,name,attrs){if(name==="component"){tagName=value(scope);delete attrs[name]}else if(this.exists(name)){modifiers.push({name:name,value:value,p:this.priority(name)});delete attrs[name]}}.bind(this));modifiers=modifiers.sort(function(a,b){return a.p-b.p});var nodes=this._transform(modifiers,tagName,config,children);return _util2["default"].isArray(nodes)?nodes:[nodes]}},{key:"_transform",value:function _transform(modifiers,tagName,config,children){if(modifiers.length){var statement=modifiers.shift();var modifier=this._modifiers[statement.name];var params=modifier(statement.value,config);return params.map(function(param){return this._transform(modifiers,tagName,param,children)}.bind(this))}var scope=config.data.scope;var component=config.data.component;if(tagName==="content"){var content=component.content();var parent=component.parent();var contentScope;if(parent){contentScope=_util2["default"].extend({},scope);contentScope.__proto__=component.parent().get()}else{contentScope=scope}return content?content(contentScope,component):[]}_util2["default"].each(config.attrs,function(value,name,attrs){if(_util2["default"].isFunction(value)){attrs[name]=value(scope)}});_util2["default"].each(config.data,function(value,name,data){if(_util2["default"].isFunction(value)){data[name]=value(scope)}});if(this._components.exists(tagName)){return this._createComponent(tagName,config,children)}return new _domLayerSrcNodeTag2["default"](tagName,config,children?children(scope,component):[])}},{key:"_createComponent",value:function _createComponent(tagName,config,children){config.hooks={created:function(node,element){var isolated=node.attrs&&node.attrs.isolated;if(!isolated||isolated.trim()!=="false"){if(node.data.scope.__proto__===Object.prototype){node.data.scope={}}else{node.data.scope.__proto__=Object.prototype}}var component=this.mount(element,node.tagName,node.data,node.data.scope,node.data.component,children)}.bind(this),remove:function(node,element){this.tree().unmount(element.domLayerTreeId)}.bind(this)};return new _domLayerSrcNodeTag2["default"](tagName,config)}},{key:"flatten",value:function flatten(input){var output=[],idx=0;for(var i=0,length=input.length;i<length;i++){var value=input[i];if(_util2["default"].isArray(value)){var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++]}}else{output[idx++]=value}}return output}},{key:"beautify",value:function beautify(value){if(value===undefined){return""}if(!_util2["default"].isPlainObject(value)){return value}var values=[];_util2["default"].each(value,function(v,k){if(v){values.push(k)}});return values.join(" ")}},{key:"cast",value:function cast(value,_cast){return _cast?_cast(value):value}},{key:"mount",value:function mount(selector,tagName,data,scope,parent,content){var containers=_domQuery2["default"].all(selector);if(!containers.length){return}if(containers.length>1){for(var i=0,len=containers.length;i<len;i++){this.mount(containers[i])}return}var container=containers[0];var component=this._components.create(tagName,{renderer:this,scope:scope,data:data,parent:parent,content:content});component.emit("mount");component.domLayerTreeId=this._tree.mount(container,component.render.bind(component),{component:component});component.emit("refresh");return component}},{key:"unmount",value:function unmount(component){this._tree.unmount(component.domLayerTreeId)}},{key:"refresh",value:function refresh(component){if(arguments.length){if(!component.dirty()||component.onrefresh){return}component.onrefresh=true;component.emit("update");this._tree.update(component.domLayerTreeId);component.emit("updated");component.onrefresh=false;component.dirty(false);return}var mountId,mounted=this._tree.mounted();for(mountId in mounted){this.refresh(mounted[mountId].component)}}}]);return Renderer}();exports["default"]=Renderer;module.exports=exports["default"]},{"./components":39,"./modifiers/each":40,"./modifiers/if":41,"./util":43,"dom-layer/src/node/tag":14,"dom-layer/src/node/text":15,"dom-layer/src/tree/tree":20,"dom-query":25}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _extendMerge=require("extend-merge");var _forEach=require("for-each");var _forEach2=_interopRequireDefault(_forEach);var _toCamelCase=require("to-camel-case");var _toCamelCase2=_interopRequireDefault(_toCamelCase);var _isNativeType=require("is-native-type");var _isNativeType2=_interopRequireDefault(_isNativeType);var _copyClone=require("copy-clone");var _copyClone2=_interopRequireDefault(_copyClone);var _path=require("./path");var _path2=_interopRequireDefault(_path);var _string=require("./string");var _string2=_interopRequireDefault(_string);var _={extend:_extendMerge.extend,merge:_extendMerge.merge,clone:_copyClone2["default"],each:_forEach2["default"],camelize:_toCamelCase2["default"],noop:function noop(){return function(){}}};(0,_extendMerge.extend)(_,_isNativeType2["default"]);(0,_extendMerge.extend)(_,_path2["default"]);(0,_extendMerge.extend)(_,_string2["default"]);exports["default"]=_;module.exports=exports["default"]},{"./path":44,"./string":45,"copy-clone":4,"extend-merge":29,"for-each":31,"is-native-type":34,"to-camel-case":35}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _={};_.set=function(object,path,value){return parsePath(object,path,value)};_.get=function(object,path){return parsePath(object,path)};function parsePath(object,path,value){if(typeof object!=="object"){throw new Error("Can't deeply get/set a value on an non object.")}if(!path){return object}var i,key,lastKey,last,current,isArray,keys,len,setMode;current=object;setMode=arguments.length===3;keys=path.replace(/\[/g,".").replace(/\]/g,"").split(".");len=keys.length;for(i=0;i<len;i++){key=keys[i];isArray=key.slice(-1)==="";lastKey=key=isArray?key.slice(0,-1):key;if(setMode&&i<len-1&&typeof current[key]!=="object"){current[key]=isArray?[]:{}}last=current;current=current[key]}return setMode?last[lastKey]=value:last[lastKey]}exports["default"]=_;module.exports=exports["default"]},{}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _={};_.escape=function(string){return string.replace(/(\\|["'])/g,"\\$1")};_.escapeRe=function(string){return string.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};_.escapeHtml=function(string){return string.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};_.unescapeHtml=function(string){return string.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};_.unquote=function(string){var a=string.charCodeAt(0);var b=string.charCodeAt(str.length-1);return a===b&&(a===34||a===39)?string.slice(1,-1):false};exports["default"]=_;module.exports=exports["default"]},{}]},{},[1])(1)});
